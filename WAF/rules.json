{
  "Upstream": "https://www.cerveceriaduarte.mx",

  "NetworkRules": [
    {
      "Network": "127.0.0.0/24",
      "Action": "Allow"
    },
    {
      "Network": "::1/64",
      "Action": "Deny"
    }
  ],

  "SessionConfig": {
    "CookieName": "PHPSESSID",
    "RenameTo": "WAFID",
    "Encrypt": true,
    "EncryptKey": "supersecurepassword",
    "SameSite": "Strict",
    "Secure": true,
    "HttpOnly": true
  },
  "Rules": [
    {
      "Method": "GET",
      "PathPattern": "/cdu/{page}",
      "SegmentRegexes": {
        "page": "^[a-z\\.]+\\.php"
      },
      "_comments": {
        "FieldRegexes": {},
        "AllowedContentTypes": [],
        "DisallowedContentTypes": [ "application/json" ]
      },
      "Action": "allow",
      "OnMatch":  "stop"
    },
    {
      "Method": "GET",
      "PathPattern": "/cdu/{page}",
      "SegmentRegexes": {
        "page": "^clientes.listado.php"
      },
      
      "Action": "deny"
    },
    {
      "Method": "GET",
      "PathPattern": "/cdu/",
      "Action": "allow"
    },
    {
      "Method": "GET",
      "PathPattern": "/img/{imagefile}",
      "SegmentRegexes": {
        "imagefile": "\\.png$"
      },
      "Action": "allow"
    },
    {
      "Method": "POST",
      "PathPattern": "/cdu/login.php",
      "_comment": {
        "SegmentRegexes": {},
        "AllowedContentTypes": [ "application/x-www-form-urlencoded" ],
        "FieldRegexes": {
          "field1": "login"
        },

        "DisallowedContentTypes": []
      },
      "Action": "allow"
    },
    {
      "Method": "POST",
      "PathPattern": "/cdu/admin/{page}",
      "_comment": {
        "SegmentRegexes": {},
        "AllowedContentTypes": [ "application/x-www-form-urlencoded" ],
        "FieldRegexes": {
          "field1": "login"
        },
        "DisallowedContentTypes": []
      },
      "Action": "allow"
    }
  ]
}